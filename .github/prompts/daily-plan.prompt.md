---
mode: "agent"
description: "日報計画を Excel の計画列（.env の PLAN_COL、デフォルト C列）に書き込む（日付省略時は今日）"
tools: ["run_in_terminal"]
---

# 日報計画の書き込み

## 手順

ユーザーの入力から **日付** と **要約テキスト** を解析し、`daily_report_writer.py` を実行して Excel の計画列（`.env` の `PLAN_COL` で設定された列、デフォルトは C列）に書き込む。

### ステップ1: 入力の解析

ユーザーが `/daily-plan` に続けて入力したテキストを以下のルールで解析する。

- **日付パターン**（`M/D` または `MM/DD` 形式）が含まれていればその日付を使用する
  - 例: `2/21 設計レビューの準備` → 日付=`2/21`、要約=`設計レビューの準備`
  - 例: `12/1 会議資料作成` → 日付=`12/1`、要約=`会議資料作成`
- **日付がない場合**は `--date` 引数を省略する（スクリプトが今日の日付を自動使用）
  - 例: `テスト計画の確認` → 要約のみ
- `要約:` というプレフィックスが付いていても取り除いて要約テキストとして扱う
- 要約テキストは 50 文字以内に切り詰めすること（スクリプト側でも自動切り詰めされる）

### ステップ2: コマンドの実行

ワークスペースルート（`c:\Users\HP\Docs\GitHub\keides2\teams-daily-report`）で以下を実行する。

**日付あり**の場合:
```powershell
python src/daily_report_writer.py --mode plan --date {MM/DD} --summary "{要約テキスト}"
```

**日付なし**（今日）の場合:
```powershell
python src/daily_report_writer.py --mode plan --summary "{要約テキスト}"
```

### ステップ3: 結果の確認と報告

- 実行結果（標準出力）を確認する
- `日報更新完了` が出力されていれば成功としてユーザーに報告する
- エラーが出力された場合はその内容をユーザーに伝え、原因（Excel が開いている、日付が見つからない等）を説明する
