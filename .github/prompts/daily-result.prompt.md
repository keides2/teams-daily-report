---
mode: "agent"
description: "日報実績を Excel の実績列（.env の RESULT_COL、デフォルト F列）に書き込む（日付省略時は今日）"
tools: ["run_in_terminal"]
---

# 日報実績の書き込み

## 手順

ユーザーの入力から **日付** と **要約テキスト** を解析し、`daily_report_writer.py` を実行して Excel の実績列（`.env` の `RESULT_COL` で設定された列、デフォルトは F列）に書き込む。

### ステップ1: 入力の解析

ユーザーが `/daily-result` に続けて入力したテキストを以下のルールで解析する。

- **日付パターン**（`M/D` または `MM/DD` 形式）が含まれていればその日付を使用する
  - 例: `2/21 テスト完了` → 日付=`2/21`、要約=`テスト完了`
  - 例: `12/1 顧客対応完了` → 日付=`12/1`、要約=`顧客対応完了`
- **日付がない場合**は `--date` 引数を省略する（スクリプトが今日の日付を自動使用）
  - 例: `バグ修正完了` → 要約のみ
- `要約:` というプレフィックスが付いていても取り除いて要約テキストとして扱う
- 要約テキストは 50 文字以内に切り詰めること（スクリプト側でも自動切り詰めされる）

### ステップ2: コマンドの実行

ワークスペースルート（`c:\Users\HP\Docs\GitHub\keides2\teams-daily-report`）で以下を実行する。

**日付あり**の場合:
```powershell
python src/daily_report_writer.py --mode result --date {MM/DD} --summary "{要約テキスト}"
```

**日付なし**（今日）の場合:
```powershell
python src/daily_report_writer.py --mode result --summary "{要約テキスト}"
```

### ステップ3: 結果の確認と報告

- 実行結果（標準出力）を確認する
- `日報更新完了` が出力されていれば成功としてユーザーに報告する
- エラーが出力された場合はその内容をユーザーに伝え、原因（Excel が開いている、日付が見つからない等）を説明する
